# ğŸ¤– AI ê¸°ë°˜ í™ˆì‡¼í•‘ ë°©ì†¡ í¸ì„± ì¶”ì²œ ì‹œìŠ¤í…œ (v2.0 - ìƒì„¸ êµ¬í˜„ ëª…ì„¸)

ë°ì´í„° ê¸°ë°˜ì˜ AI ì˜ˆì¸¡ì„ í†µí•´ ë°©ì†¡ í¸ì„± íš¨ìœ¨ì„ ê·¹ëŒ€í™”í•˜ëŠ” ë°±ì—”ë“œ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

## ğŸ“– ëª©ì°¨

1. [í”„ë¡œì íŠ¸ ê°œìš”](#-í”„ë¡œì íŠ¸-ê°œìš”)
2. [ì£¼ìš” ê¸°ëŠ¥](#-ì£¼ìš”-ê¸°ëŠ¥)
3. [ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤](#-ì‚¬ìš©ì-ì‹œë‚˜ë¦¬ì˜¤)
4. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
5. [ê¸°ìˆ  ìŠ¤íƒ](#-ê¸°ìˆ -ìŠ¤íƒ)
6. [ìƒì„¸ ì•Œê³ ë¦¬ì¦˜ ëª…ì„¸](#-ìƒì„¸-ì•Œê³ ë¦¬ì¦˜-ëª…ì„¸)
   - 6.1. [ë©”ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ ì˜ì‚¬ì½”ë“œ](#61-ë©”ì¸-ì»¨íŠ¸ë¡¤ëŸ¬-ì˜ì‚¬ì½”ë“œ)
   - 6.2. [Track A/B ë³‘ë ¬ ì²˜ë¦¬ ë° ê²°ê³¼ í†µí•©](#62-track-ab-ë³‘ë ¬-ì²˜ë¦¬-ë°-ê²°ê³¼-í†µí•©)
   - 6.3. [ìµœì¢… ìƒí’ˆ ë­í‚¹ ì ìˆ˜ ê³µì‹](#63-ìµœì¢…-ìƒí’ˆ-ë­í‚¹-ì ìˆ˜-ê³µì‹)
   - 6.4. [RAG ê²€ìƒ‰ íŒŒë¼ë¯¸í„° ì„¤ì •](#64-rag-ê²€ìƒ‰-íŒŒë¼ë¯¸í„°-ì„¤ì •)
7. [ë°ì´í„° í”Œë¡œìš° ë° í˜•ì‹](#-ë°ì´í„°-í”Œë¡œìš°-ë°-í˜•ì‹)
8. [ì„±ëŠ¥ ê¸°ì¤€ ë° ìºì‹± ì „ëµ](#-ì„±ëŠ¥-ê¸°ì¤€-ë°-ìºì‹±-ì „ëµ)
9. [LangChain ì›Œí¬í”Œë¡œìš° ìƒì„¸](#-langchain-ì›Œí¬í”Œë¡œìš°-ìƒì„¸)
10. [XGBoost ëª¨ë¸ í•™ìŠµ ë°ì´í„°](#-xgboost-ëª¨ë¸-í•™ìŠµ-ë°ì´í„°)
11. [API ëª…ì„¸ì„œ](#-api-ëª…ì„¸ì„œ)
12. [ì‹œì‘í•˜ê¸° (ê°œë°œ í™˜ê²½ ì„¤ì •)](#-ì‹œì‘í•˜ê¸°-ê°œë°œ-í™˜ê²½-ì„¤ì •)

---

## ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”

### ğŸ¯ ë¬¸ì œ ì •ì˜
í™ˆì‡¼í•‘ ë°©ì†¡ í¸ì„± ê³¼ì •ì—ì„œ ë°œìƒí•˜ëŠ” **ê³µë°± ì‹œê°„ì„ í¸ì„±í•˜ëŠ” ì‘ì—…**ì€ PDì™€ MDì˜ ê²½í—˜ê³¼ ì§ê´€ì— í¬ê²Œ ì˜ì¡´í•´ì™”ìŠµë‹ˆë‹¤. ì´ëŠ” ë¹„íš¨ìœ¨ì ì¼ ë¿ë§Œ ì•„ë‹ˆë¼, ë°©ëŒ€í•œ ë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬ ë§¤ì¶œì„ ê·¹ëŒ€í™”í•  ê¸°íšŒë¥¼ ë†“ì¹˜ëŠ” ì›ì¸ì´ ë©ë‹ˆë‹¤.

### ğŸ’¡ í•´ê²° ë°©ì•ˆ
ë³¸ í”„ë¡œì íŠ¸ëŠ” **ìµœì‹  íŠ¸ë Œë“œ, ë‚ ì”¨, ê²½ìŸì‚¬ í¸ì„± í˜„í™©, ê³¼ê±° íŒë§¤ ë°ì´í„°** ë“± ë‹¤ì–‘í•œ ìš”ì†Œë¥¼ ì¢…í•©ì ìœ¼ë¡œ ë¶„ì„í•˜ëŠ” AI ëª¨ë¸ì„ í†µí•´, ì£¼ì–´ì§„ ê³µë°± ì‹œê°„ì— ê°€ì¥ ë†’ì€ ë§¤ì¶œì„ ê¸°ëŒ€í•  ìˆ˜ ìˆëŠ” **ìµœì ì˜ ìƒí’ˆì„ ìë™ìœ¼ë¡œ ì¶”ì²œ**í•˜ëŠ” ì‹œìŠ¤í…œì„ êµ¬ì¶•í•©ë‹ˆë‹¤.

### ğŸš€ í•µì‹¬ ëª©í‘œ

- â° **ê³µë°± ì‹œê°„ í¸ì„±ì— ì†Œìš”ë˜ëŠ” ì‹œê°„ ë° ì¸ë ¥ ìµœì†Œí™”**
- ğŸ“ˆ **ë°ì´í„° ê¸°ë°˜ ì¶”ì²œì„ í†µí•œ ë°©ì†¡ ë§¤ì¶œ ì¦ëŒ€**  
- ğŸ¯ **PD/MDì˜ í¸ì„±ì„ ë•ëŠ” ê°•ë ¥í•œ ì˜ì‚¬ê²°ì • ì§€ì› ë„êµ¬ ì œê³µ**

---

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

- **ğŸ¯ ì‹¤ì‹œê°„ AI ìƒí’ˆ ì¶”ì²œ**: íŠ¹ì • ë°©ì†¡ ì‹œê°„ì„ ì§€ì •í•˜ë©´, í•´ë‹¹ ì‹œê°„ì— ê°€ì¥ ì í•©í•œ ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¶”ì²œí•©ë‹ˆë‹¤.

- **ğŸ“Š ë°ì´í„° ê¸°ë°˜ ë¶„ì„**: ê³¼ê±° ë°©ì†¡ ì‹¤ì , ë‚ ì”¨, ê¸°ë…ì¼, ì™¸ë¶€ ìµœì‹  íŠ¸ë Œë“œ í‚¤ì›Œë“œë¥¼ ì¢…í•©í•˜ì—¬ ì¶”ì²œ ê·¼ê±°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

- **âš”ï¸ ì „ëµì  ê²½ìŸì‚¬ ë¶„ì„**: ë™ì‹œê°„ëŒ€ ê²½ìŸì‚¬ í¸ì„± ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬, í‹ˆìƒˆì‹œì¥ì„ ê³µëµí•˜ê±°ë‚˜ ë§ë¶ˆ ì‘ì „ì„ í¼ì¹˜ëŠ” ë“± ì „ëµì ì¸ ì¶”ì²œì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

- **ğŸ§  í•˜ì´ë¸Œë¦¬ë“œ ì¶”ì²œ ë¡œì§**: ì˜ë¯¸ ê¸°ë°˜ ê²€ìƒ‰(RAG)ê³¼ ë¨¸ì‹ ëŸ¬ë‹ ë§¤ì¶œ ì˜ˆì¸¡(XGBoost)ì„ ê²°í•©í•˜ì—¬ ì¶”ì²œì˜ ì •í™•ì„±ê³¼ ì„¤ë“ë ¥ì„ ë†’ì…ë‹ˆë‹¤.

- **ğŸ§‘â€ğŸ’» ì „ë¬¸ê°€ ìµœì¢… ê²°ì • (Human-in-the-loop)**: AIëŠ” ìµœì ì˜ í›„ë³´êµ°ì„ ì œì‹œí•˜ê³ , ìµœì¢… ì„ íƒì€ í¸ì„± ì „ë¬¸ê°€ì¸ PDê°€ ìˆ˜í–‰í•˜ì—¬ ì‹œìŠ¤í…œì˜ ì•ˆì •ì„±ê³¼ ìœ ì—°ì„±ì„ í™•ë³´í•©ë‹ˆë‹¤.

- **ğŸ”„ ì£¼ê¸°ì  ë°ì´í„° ìˆ˜ì§‘**: ë°°ì¹˜ ì„œë²„(n8n)ê°€ ì£¼ê¸°ì ìœ¼ë¡œ ì™¸ë¶€ íŠ¸ë Œë“œ ë° ê²½ìŸì‚¬ í¸ì„± ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ì—¬ ìµœì‹ ì„±ì„ ìœ ì§€í•©ë‹ˆë‹¤.

---

## ğŸ‘¤ ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤

1. **ê³µë°± ì‹œê°„ í™•ì¸**: PDê°€ ë°©ì†¡ í¸ì„± ì›¹í˜ì´ì§€ì—ì„œ ë¹„ì–´ìˆëŠ” í¸ì„± ìŠ¬ë¡¯ì„ í™•ì¸í•©ë‹ˆë‹¤.

2. **AI ì¶”ì²œ ìš”ì²­**: í•´ë‹¹ ìŠ¬ë¡¯ì˜ 'AI ì¶”ì²œ' ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.

3. **ì¶”ì²œ ê²°ê³¼ í™•ì¸**: ì ì‹œ í›„, ì¶”ì²œ ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ê°€ ë‹´ê¸´ íŒì—…ì°½ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. ë¦¬ìŠ¤íŠ¸ëŠ” AIê°€ ë§¤ê¸´ ì¶”ì²œ ì ìˆ˜ ìˆœìœ¼ë¡œ ì •ë ¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

4. **ì¶”ì²œ ê·¼ê±° íŒŒì•…**: ê° ìƒí’ˆë³„ë¡œ ì™œ ì¶”ì²œë˜ì—ˆëŠ”ì§€ì— ëŒ€í•œ ëª…í™•í•œ ì´ìœ (ì˜ˆìƒ ë§¤ì¶œ, ê´€ë ¨ íŠ¸ë Œë“œ í‚¤ì›Œë“œ, ê²½ìŸ ìƒí™© ë“±)ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.

5. **ìµœì¢… í¸ì„± í™•ì •**: PDëŠ” ì œì‹œëœ í›„ë³´êµ° ì¤‘ì—ì„œ ê°€ì¥ ì í•©í•˜ë‹¤ê³  íŒë‹¨í•˜ëŠ” ìƒí’ˆì„ ì„ íƒí•˜ì—¬ í¸ì„±ì„ ìµœì¢… í™•ì •í•©ë‹ˆë‹¤.

---

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

ë³¸ ì‹œìŠ¤í…œì€ **ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜(MSA)**ë¥¼ ì±„íƒí•˜ì—¬, ì‹¤ì‹œê°„ ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” AI ë°±ì—”ë“œ ì„œë²„ì™€ ì£¼ê¸°ì ì¸ ë°ì´í„° ìˆ˜ì§‘ì„ ë‹´ë‹¹í•˜ëŠ” ë°°ì¹˜ ì„œë²„ì˜ ì—­í• ì„ ëª…í™•íˆ ë¶„ë¦¬í•˜ì—¬ ì•ˆì •ì„±ê³¼ í™•ì¥ì„±ì„ í™•ë³´í–ˆìŠµë‹ˆë‹¤.

### ì£¼ìš” êµ¬ì„±ìš”ì†Œ

- **AI ë°±ì—”ë“œ ì„œë²„ (FastAPI)**: ì‚¬ìš©ìì˜ ì‹¤ì‹œê°„ ì¶”ì²œ ìš”ì²­ì„ ë°›ì•„ AI ì—°ì‚° ë° ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìˆ˜í–‰í•˜ëŠ” í•µì‹¬ ì„œë²„ì…ë‹ˆë‹¤.

- **ë°°ì¹˜ ì„œë²„ (n8n)**: ì£¼ê¸°ì ìœ¼ë¡œ ì™¸ë¶€ ì›¹ì‚¬ì´íŠ¸ ë° APIë¥¼ í†µí•´ ìµœì‹  íŠ¸ë Œë“œì™€ ê²½ìŸì‚¬ í¸ì„± ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê³  RDBì— ì €ì¥í•˜ëŠ” ì—­í• ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.

- **RDB (PostgreSQL)**: ìƒí’ˆ ì •ë³´, ê³¼ê±° ë§¤ì¶œ ë°ì´í„°, ê²½ìŸì‚¬ í¸ì„± ë°ì´í„° ë“± ëª¨ë“  ì •í˜• ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.

- **Vector DB (Qdrant)**: ìƒí’ˆ ë° ì¹´í…Œê³ ë¦¬ ì •ë³´ì˜ í…ìŠ¤íŠ¸ë¥¼ ë²¡í„°ë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥í•˜ê³ , ì˜ë¯¸ ê¸°ë°˜ ê²€ìƒ‰(RAG)ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

---

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

| êµ¬ë¶„ | ê¸°ìˆ  | ì—­í•  ë° ì´ìœ  |
|------|------|-------------|
| **AI ë°±ì—”ë“œ ì„œë²„** | Python & FastAPI | AI/ML ìƒíƒœê³„ì˜ í‘œì¤€. ë¹ ë¥´ê³  í˜„ëŒ€ì ì¸ API ì„œë²„ êµ¬ì¶•ì— ìµœì í™” |
| **AI í”„ë ˆì„ì›Œí¬** | LangChain | RAG, ëª¨ë¸ í˜¸ì¶œ, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë“± ë³µì¡í•œ AI ì›Œí¬í”Œë¡œìš°ë¥¼ ì§€íœ˜í•˜ëŠ” ì—­í•  |
| **ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸** | XGBoost | ì¹´í…Œê³ ë¦¬ë³„ ë§¤ì¶œ ì˜ˆì¸¡ì„ ìœ„í•œ ê³ ì„±ëŠ¥ ML ëª¨ë¸ |
| **RDB** | PostgreSQL | ìƒí’ˆ, ë§¤ì¶œ, ê²½ìŸì‚¬ ë°ì´í„° ë“± í•µì‹¬ ì •í˜• ë°ì´í„°ë¥¼ ì•ˆì •ì ìœ¼ë¡œ ê´€ë¦¬ |
| **Vector DB** | Qdrant | ê³ ì„±ëŠ¥ ë²¡í„° ê²€ìƒ‰ ì—”ì§„. Rust ê¸°ë°˜ìœ¼ë¡œ ë¹ ë¥´ê³  ê°€ë²¼ì›Œ ì´ˆê¸° êµ¬ì¶•ì— ìœ ë¦¬ |
| **ë°°ì¹˜ ì„œë²„** | n8n | ì£¼ê¸°ì ì¸ ë°ì´í„° ìˆ˜ì§‘ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹œê°ì ìœ¼ë¡œ ì‰½ê²Œ êµ¬ì¶•í•˜ê³  ê´€ë¦¬ |
| **DevOps** | Docker, GitHub Actions | ê°œë°œ í™˜ê²½ í†µì¼ ë° CI/CD ìë™í™” (ê¶Œì¥) |

---

## ğŸ“‹ ìƒì„¸ ì•Œê³ ë¦¬ì¦˜ ëª…ì„¸

ë³¸ ì„¹ì…˜ì€ ì‹œìŠ¤í…œì˜ í•µì‹¬ ë¡œì§ì„ êµ¬ì²´ì ì¸ ì˜ì‚¬ì½”ë“œì™€ ê³µì‹, íŒŒë¼ë¯¸í„° ê°’ìœ¼ë¡œ ëª…ì„¸í•©ë‹ˆë‹¤.

### 6.1. ë©”ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ ì˜ì‚¬ì½”ë“œ

FastAPIì˜ API ì—”ë“œí¬ì¸íŠ¸ì—ì„œ í˜¸ì¶œë  ë©”ì¸ í•¨ìˆ˜ì˜ ë…¼ë¦¬ì  íë¦„ì…ë‹ˆë‹¤.

```python
# main.py - /api/v1/broadcast/recommendations

async def get_recommendations(request: Request):
    # 1. ì»¨í…ìŠ¤íŠ¸ ìˆ˜ì§‘ ë° í‚¤ì›Œë“œ ë¶„ë¥˜
    context = await gather_context(request.broadcastTime)
    classified_keywords = await classify_keywords(context.trends)

    # 2. Track A, B ë¹„ë™ê¸° ë³‘ë ¬ ì‹¤í–‰
    # asyncio.gatherë¥¼ ì‚¬ìš©í•˜ì—¬ ë‘ íŠ¸ë™ì„ ë™ì‹œì— ì‹¤í–‰
    track_a_result, track_b_result = await asyncio.gather(
        execute_track_a(context, classified_keywords.category_keywords),
        execute_track_b(context, classified_keywords.product_keywords)
    )

    # 3. í›„ë³´êµ° ìƒì„± ë° í†µí•©
    candidate_products = await generate_candidates(
        promising_categories=track_a_result.categories,
        trend_products=track_b_result.products
    )

    # 4. ìµœì¢… ë­í‚¹ ê³„ì‚°
    ranked_products = await rank_final_candidates(
        candidate_products,
        category_scores=track_a_result.scores,
        context=context
    )

    # 5. API ì‘ë‹µ ìƒì„±
    return format_response(ranked_products, track_a_result.categories)
```

### 6.2. Track A/B ë³‘ë ¬ ì²˜ë¦¬ ë° ê²°ê³¼ í†µí•©

**ë³‘ë ¬ ì²˜ë¦¬ ë°©ë²•:** Pythonì˜ `asyncio.gather`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‘ ê°œì˜ ë¹„ë™ê¸° í•¨ìˆ˜(`execute_track_a`, `execute_track_b`)ë¥¼ ë™ì‹œì— ì‹¤í–‰í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ I/O ë°”ìš´ë“œ ì‘ì—…(DB ì¡°íšŒ, API í˜¸ì¶œ) ëŒ€ê¸° ì‹œê°„ì„ ìµœì†Œí™”í•©ë‹ˆë‹¤.

**ê²°ê³¼ í†µí•© ë¡œì§:**
1. `execute_track_b`ì—ì„œ ë°˜í™˜ëœ 'ìƒí’ˆ íŠ¹ì •' ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ë¥¼ ìµœì¢… í›„ë³´êµ°ì— ë¨¼ì € ì¶”ê°€í•©ë‹ˆë‹¤.
2. `execute_track_a`ì—ì„œ ë°˜í™˜ëœ 'ìœ ë§ ì¹´í…Œê³ ë¦¬' ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆœíšŒí•˜ë©°, ê° ì¹´í…Œê³ ë¦¬ë³„ë¡œ RDBì—ì„œ 'ì—ì´ìŠ¤ ìƒí’ˆ'(íŒë§¤ëŸ‰ ìƒìœ„ 100ê°œ ë“±)ì„ SQLë¡œ ì¡°íšŒí•©ë‹ˆë‹¤.
3. ë‘ ë¦¬ìŠ¤íŠ¸ë¥¼ í•©ì¹œ í›„, `product_id`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¤‘ë³µì„ ì œê±°í•˜ì—¬ ìµœì¢… í›„ë³´êµ°(Candidate Pool)ì„ ìƒì„±í•©ë‹ˆë‹¤.

### 6.3. ìµœì¢… ìƒí’ˆ ë­í‚¹ ì ìˆ˜ ê³µì‹

**ê°€ì¤‘ì¹˜ (W1, W2):** ì´ˆê¸°ê°’ì€ ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ì— ë”°ë¼ ì„¤ì •í•˜ë©°, í–¥í›„ A/B í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ìµœì í™”í•©ë‹ˆë‹¤.
- **W1 (ì¹´í…Œê³ ë¦¬ ì í•©ë„ ê°€ì¤‘ì¹˜):** 0.6
- **W2 (ê²½ìŸ ìƒí™© ê°€ì¤‘ì¹˜):** 0.3

**ìµœì¢… ì ìˆ˜ ê³µì‹:**
```
Final_Score = (Category_Score * W1) + Individual_Score - (Competition_Penalty * W2)
```

**ê° ì ìˆ˜ ê³„ì‚° ë°©ë²•:**
- **Category_Score (0~1):** ìƒí’ˆì´ ì†í•œ ì¹´í…Œê³ ë¦¬ê°€ Track Aì—ì„œ ë°›ì€ ìµœì¢… ì ìˆ˜. (XGBoost ì˜ˆì¸¡ê°’ê³¼ RAG ê´€ë ¨ì„± ì ìˆ˜ë¥¼ í•©ì‚° í›„ Min-Max ì •ê·œí™”)
- **Individual_Score (0~1):** ìƒí’ˆ ê°œë³„ ì§€í‘œë¥¼ í•©ì‚°í•œ ì ìˆ˜.
  ```
  (Normalized_Past_Sales * 0.5) + (Normalized_Margin_Rate * 0.3) + (Normalized_Stock_Level * 0.2)
  ```
- **Competition_Penalty (0 ë˜ëŠ” 1):** ë™ì‹œê°„ëŒ€ ê²½ìŸì‚¬ê°€ ë™ì¼ ì¹´í…Œê³ ë¦¬(ì¤‘ë¶„ë¥˜ ê¸°ì¤€) ìƒí’ˆì„ ë°©ì†¡í•  ê²½ìš° 1, ì•„ë‹ ê²½ìš° 0.

**ì •ê·œí™”:** ëª¨ë“  ê°œë³„ ì§€í‘œ(ê³¼ê±° ë§¤ì¶œ, ë§ˆì§„ìœ¨ ë“±)ëŠ” í›„ë³´êµ° ë‚´ì—ì„œ Min-Max Scalingì„ ì‚¬ìš©í•˜ì—¬ 0ê³¼ 1 ì‚¬ì´ì˜ ê°’ìœ¼ë¡œ ì •ê·œí™”í•©ë‹ˆë‹¤. `(value - min) / (max - min)`

### 6.4. RAG ê²€ìƒ‰ íŒŒë¼ë¯¸í„° ì„¤ì •

Qdrant(Vector DB) ê²€ìƒ‰ ì‹œ ì‚¬ìš©í•  êµ¬ì²´ì ì¸ íŒŒë¼ë¯¸í„°ì…ë‹ˆë‹¤.

**ê²€ìƒ‰ ëŒ€ìƒ:** ì¹´í…Œê³ ë¦¬ ì¸ë±ìŠ¤, ìƒí’ˆ ì¸ë±ìŠ¤

**top_k (ë°˜í™˜í•  ê²°ê³¼ ìˆ˜):**
- ì¹´í…Œê³ ë¦¬ ê²€ìƒ‰ ì‹œ: `k = 5`
- ìƒí’ˆ ê²€ìƒ‰ ì‹œ: `k = 20`

**score_threshold (ìµœì†Œ ìœ ì‚¬ë„ ì„ê³„ê°’):**
- `threshold = 0.7` (ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ê¸°ì¤€, ì´ ê°’ë³´ë‹¤ ë‚®ìœ¼ë©´ ê²°ê³¼ì—ì„œ ì œì™¸)

**í•„í„°ë§ ì¡°ê±´ (Metadata Filtering):**
- ëª¨ë“  ìƒí’ˆ ê²€ìƒ‰ ì‹œ `is_active = true`, `stock_level > 0` ê³¼ ê°™ì€ í•„í„°ë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì ìš©í•˜ì—¬ íŒë§¤ ë¶ˆê°€ëŠ¥í•œ ìƒí’ˆì„ ì‚¬ì „ì— ì œì™¸í•©ë‹ˆë‹¤.

---

## ğŸ“Š ë°ì´í„° í”Œë¡œìš° ë° í˜•ì‹

**ë°ì´í„° í”Œë¡œìš° ë‹¤ì´ì–´ê·¸ë¨ (í…ìŠ¤íŠ¸ ê¸°ë°˜):**
```
Request (broadcastTime) -> [ì»¨íŠ¸ë¡¤ëŸ¬] -> gather_context -> Context Object 
-> [Track A | Track B] -> [Category_Result | Product_Result] 
-> generate_candidates -> List[Product] -> rank_candidates 
-> List[Ranked_Product] -> [API ì‘ë‹µ]
```

**ì£¼ìš” ë°ì´í„° í˜•ì‹ (Pydantic ëª¨ë¸ ì˜ˆì‹œ):**
```python
class Context:
    broadcast_time: datetime
    weather: str
    is_holiday: bool
    trends: List[str]
    competitors: List[CompetitorInfo]

class RankedProduct:
    product_id: str
    product_name: str
    final_score: float
    reasoning: Dict[str, Any]
```

**ì—ëŸ¬ í•¸ë“¤ë§:**
- Vector DB/RDB ì—°ê²° ì‹¤íŒ¨: `503 Service Unavailable` ì‘ë‹µ.
- XGBoost ëª¨ë¸ ë¡œë“œ ì‹¤íŒ¨: `500 Internal Server Error` ì‘ë‹µ.
- ìœ íš¨í•˜ì§€ ì•Šì€ broadcastTime: `400 Bad Request` ì‘ë‹µ.

---

## âš¡ ì„±ëŠ¥ ê¸°ì¤€ ë° ìºì‹± ì „ëµ

**API ì‘ë‹µ ì‹œê°„ ëª©í‘œ:** ìµœì¢… ì‚¬ìš©ì(PD)ì˜ ê²½í—˜ì„ ìœ„í•´, API ìš”ì²­ë¶€í„° ì‘ë‹µê¹Œì§€ í‰ê·  2ì´ˆ, ìµœëŒ€ 3ì´ˆë¥¼ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

**ì¶”ì²œ ì •í™•ë„ ê¸°ì¤€ (ì´ˆê¸°):** ì¶”ì²œëœ ìƒìœ„ 5ê°œ ìƒí’ˆ ì¤‘ 1ê°œ ì´ìƒì´ ì‹¤ì œ í¸ì„±ìœ¼ë¡œ ì´ì–´ì§€ëŠ” ë¹„ìœ¨(Hit Rate @5)ì„ 30% ì´ìƒìœ¼ë¡œ ëª©í‘œ ì„¤ì •í•˜ê³ , í”¼ë“œë°±ì„ í†µí•´ ì§€ì†ì ìœ¼ë¡œ ê°œì„ í•©ë‹ˆë‹¤.

**ìºì‹± ì „ëµ:**
- **ë‚ ì”¨, ê³µíœ´ì¼ ì •ë³´:** ì™¸ë¶€ API í˜¸ì¶œ ê²°ê³¼ë¥¼ 1ì‹œê°„ ì£¼ê¸°ë¡œ ìºì‹±í•©ë‹ˆë‹¤. (Redis ë˜ëŠ” ì¸ë©”ëª¨ë¦¬ ìºì‹œ ì‚¬ìš©)
- **íŠ¸ë Œë“œ í‚¤ì›Œë“œ:** n8nì´ ìˆ˜ ì‹œê°„ ì£¼ê¸°ë¡œ ì—…ë°ì´íŠ¸í•˜ë¯€ë¡œ, API ì„œë²„ ì‹œì‘ ì‹œ ë©”ëª¨ë¦¬ì— ë¡œë“œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
- **Vector DB ì—°ê²°:** ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ì‹œ ì»¤ë„¥ì…˜ í’€ì„ ìƒì„±í•˜ì—¬ ì¬ì‚¬ìš©í•©ë‹ˆë‹¤.

---

## ğŸ”— LangChain ì›Œí¬í”Œë¡œìš° ìƒì„¸

**í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ (í‚¤ì›Œë“œ ë¶„ë¥˜ê¸°):**
```
You are a helpful assistant. Classify the given keywords into 'category_keywords' which are general situations or lifestyles, and 'product_keywords' which are specific brand or product names.

Keywords: [{keywords}]

Respond ONLY in JSON format like this:
{
  "category_keywords": ["list of keywords"],
  "product_keywords": ["list of keywords"]
}
```

**Chain êµ¬ì„± (LCEL - LangChain Expression Language):**
```python
# ì˜ì‚¬ì½”ë“œ ì˜ˆì‹œ
prompt = ChatPromptTemplate.from_template(template)
model = ChatOpenAI(model="gpt-4-turbo")
parser = JsonOutputParser()

classification_chain = prompt | model | parser
```

**ì—ëŸ¬ ì²˜ë¦¬:** LLM ì‘ë‹µì´ JSON í˜•ì‹ì´ ì•„ë‹ˆê±°ë‚˜, API í˜¸ì¶œì— ì‹¤íŒ¨í•  ê²½ìš° ì¬ì‹œë„(Retry) ë¡œì§ì„ 2íšŒ ìˆ˜í–‰í•˜ê³ , ìµœì¢… ì‹¤íŒ¨ ì‹œ ëª¨ë“  í‚¤ì›Œë“œë¥¼ 'ì¹´í…Œê³ ë¦¬ í‚¤ì›Œë“œ'ë¡œ ê°„ì£¼í•˜ì—¬ ì‹œìŠ¤í…œ ì¤‘ë‹¨ì„ ë°©ì§€í•©ë‹ˆë‹¤.

---

## âš¡ ìƒì„¸ ì›Œí¬í”Œë¡œìš°

ì‚¬ìš©ì ìš”ì²­ë¶€í„° ì‘ë‹µê¹Œì§€ AI ë°±ì—”ë“œ ì„œë²„ ë‚´ë¶€ì—ì„œ ì¼ì–´ë‚˜ëŠ” ìƒì„¸í•œ ë™ì‘ ê³¼ì •ì…ë‹ˆë‹¤.

### 1ë‹¨ê³„: AIì˜ ë°©í–¥ íƒìƒ‰ (ìˆ² ì°¾ê¸°)

#### ìš”ì²­ ë¶„ì„ ë° ì»¨í…ìŠ¤íŠ¸ ìˆ˜ì§‘
- API ìš”ì²­ìœ¼ë¡œ `broadcastTime`ì„ ë°›ìŠµë‹ˆë‹¤.
- í•´ë‹¹ ì‹œê°„ì„ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì”¨, ê³µíœ´ì¼ ì •ë³´, ê²½ìŸì‚¬ í¸ì„± í˜„í™© ë“± ì‹¤ì‹œê°„ ë° ì‚¬ì „ ìˆ˜ì§‘ ë°ì´í„°ë¥¼ ëª¨ë‘ ë¡œë“œí•©ë‹ˆë‹¤.
- ìˆ˜ì§‘ëœ ëª¨ë“  í‚¤ì›Œë“œë¥¼ LangChainì„ í†µí•´ **'ì¹´í…Œê³ ë¦¬ ì—°ê´€ í‚¤ì›Œë“œ'**ì™€ 'ìƒí’ˆ íŠ¹ì • í‚¤ì›Œë“œ' ë‘ ê·¸ë£¹ìœ¼ë¡œ ìë™ ë¶„ë¥˜í•©ë‹ˆë‹¤.

#### ë³‘ë ¬ ê²€ìƒ‰ ë° ì˜ˆì¸¡ (Hybrid Search & Prediction)

**Track A (ì¹´í…Œê³ ë¦¬ íŠ¸ë™):**
- ì¹´í…Œê³ ë¦¬ ì—°ê´€ í‚¤ì›Œë“œì™€ ê²½ìŸ ìƒí™©("ê²½ìŸì´ ì—†ëŠ” ì¹´í…Œê³ ë¦¬ ì°¾ì•„ì¤˜" ë“±)ì„ ì¡°í•©í•˜ì—¬ ì˜ë¯¸ ìˆëŠ” ì¿¼ë¦¬ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
- LangChainì´ ì´ ì¿¼ë¦¬ë¥¼ **Qdrant(Vector DB)**ë¡œ ë³´ë‚´ RAG ê²€ìƒ‰ì„ ì‹¤í–‰, ì˜ë¯¸ì ìœ¼ë¡œ ê°€ì¥ ìœ ì‚¬í•œ ì¹´í…Œê³ ë¦¬ í›„ë³´êµ°ì„ ì–»ìŠµë‹ˆë‹¤.
- ì´ ì†Œìˆ˜ì˜ ì¹´í…Œê³ ë¦¬ í›„ë³´êµ°ì— ëŒ€í•´ì„œë§Œ ê²½ìŸì‚¬ í¸ì„± ë°ì´í„°ë¥¼ í¬í•¨í•˜ì—¬ í•™ìŠµëœ XGBoost ëª¨ë¸ì„ í˜¸ì¶œ, ì˜ˆìƒ ë§¤ì¶œì•¡ì„ ì˜ˆì¸¡í•©ë‹ˆë‹¤.
- ê´€ë ¨ì„± ì ìˆ˜ì™€ ì˜ˆìƒ ë§¤ì¶œì•¡ì„ ê°€ì¤‘ í•©ì‚°í•˜ì—¬ **'ì˜¤ëŠ˜ì˜ ìœ ë§ ì¹´í…Œê³ ë¦¬ TOP 3'**ë¥¼ ìµœì¢… ì„ ì •í•©ë‹ˆë‹¤.

**Track B (ìƒí’ˆ íŠ¸ë™):**
- ìƒí’ˆ íŠ¹ì • í‚¤ì›Œë“œë¥¼ LangChainì— ì „ë‹¬, **Qdrant(Vector DB)**ë¥¼ RAG ê²€ìƒ‰í•˜ì—¬ ê´€ë ¨ ê°œë³„ ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ë¥¼ ì§ì ‘ ì°¾ì•„ëƒ…ë‹ˆë‹¤.

### 2ë‹¨ê³„: ìµœì¢… í›„ë³´ ì„ ì • ë° ê³ ì† ë­í‚¹ (ë‚˜ë¬´ ê³ ë¥´ê¸°)

#### í›„ë³´êµ° ìƒì„± (Candidate Generation)
- Track Bì—ì„œ ì°¾ì€ ìƒí’ˆë“¤ì„ ìµœì¢… í›„ë³´êµ°ì— í¬í•¨ì‹œí‚µë‹ˆë‹¤.
- Track Aì—ì„œ ì°¾ì€ 'ìœ ë§ ì¹´í…Œê³ ë¦¬'ì— ëŒ€í•´, PostgreSQLì— SQL ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ì—¬ ì—ì´ìŠ¤ ìƒí’ˆë“¤ì„ ì„ ë³„í•´ í›„ë³´êµ°ì— ì¶”ê°€í•©ë‹ˆë‹¤.

#### ê°€ë²¼ìš´ ê·œì¹™ ê¸°ë°˜ ë­í‚¹ (Lightweight Ranking)
- í†µí•©ëœ í›„ë³´ ìƒí’ˆë“¤ì„ ëŒ€ìƒìœ¼ë¡œ ë‹¨ìˆœí•œ ì ìˆ˜ ê³µì‹ìœ¼ë¡œ ìµœì¢… ìˆœìœ„ë¥¼ ë§¤ê¹ë‹ˆë‹¤.

**ì ìˆ˜ ê³µì‹ ì˜ˆì‹œ:**
```
ìƒí’ˆ ìµœì¢… ì ìˆ˜ = (â‘  ì¹´í…Œê³ ë¦¬ ì ìˆ˜ Ã— W1) + (â‘¡ ìƒí’ˆ ê°œë³„ ì ìˆ˜) - (â‘¢ ê²½ìŸ í˜ë„í‹° ì ìˆ˜ Ã— W2)
```

- **â‘¢ ê²½ìŸ í˜ë„í‹° ì ìˆ˜**: ì¶”ì²œ ìƒí’ˆê³¼ ë™ì‹œê°„ëŒ€ ê²½ìŸì‚¬ ìƒí’ˆì˜ ì¹´í…Œê³ ë¦¬ê°€ ê²¹ì¹  ê²½ìš° ë¶€ì—¬ë˜ëŠ” í˜ë„í‹°ì…ë‹ˆë‹¤.

#### API ì‘ë‹µ ìƒì„±
- ìµœì¢… ì ìˆ˜ê°€ ë†’ì€ ìˆœì„œëŒ€ë¡œ ìƒí’ˆì„ ì •ë ¬í•˜ì—¬ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µì„ ìƒì„±í•©ë‹ˆë‹¤.

---

## ğŸ“Š XGBoost ëª¨ë¸ í•™ìŠµ ë°ì´í„°

ì¹´í…Œê³ ë¦¬ë³„ ë§¤ì¶œ ì˜ˆì¸¡ ëª¨ë¸(XGBoost)ì„ í•™ìŠµì‹œí‚¤ê¸° ìœ„í•œ ë°ì´í„° í…Œì´ë¸”(Training Data)ì˜ ì˜ˆì‹œì…ë‹ˆë‹¤. ê³¼ê±° ë°©ì†¡ í¸ì„± ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì¶•í•˜ë©°, **ê²½ìŸì‚¬ í˜„í™©ê³¼ ê³µíœ´ì¼ ì •ë³´**ê°€ í•µì‹¬ í”¼ì²˜(Feature)ë¡œ í¬í•¨ë©ë‹ˆë‹¤.

### ì£¼ìš” í”¼ì²˜ (Features)

| í”¼ì²˜ëª… | ì„¤ëª… | ì˜ˆì‹œ |
|--------|------|------|
| `broadcast_timestamp` | ë°©ì†¡ ë‚ ì§œ ë° ì‹œê°„ | 2024-10-01 22:00 |
| `day_of_week` | ìš”ì¼ | í™”ìš”ì¼ |
| `category_name` | ë°©ì†¡ëœ ìƒí’ˆì˜ ì¹´í…Œê³ ë¦¬ | íŒ¨ì…˜ì˜ë¥˜, ì£¼ë°©ìš©í’ˆ |
| `is_holiday` | ê³µíœ´ì¼ ì—¬ë¶€ (1 or 0) | 1 (ê³µíœ´ì¼), 0 (í‰ì¼) |
| `temperature` | ë‹¹ì‹œ ê¸°ì˜¨ | 23.5Â°C |
| `competitor_count_same_category` | ë™ì‹œê°„ëŒ€ ë™ì¼ ì¹´í…Œê³ ë¦¬ë¥¼ ë°©ì†¡í•˜ëŠ” ê²½ìŸì‚¬ ìˆ˜ | 2ê°œì‚¬ |

### íƒ€ê²Ÿ ë³€ìˆ˜ (Label)

- **`actual_sales_amount`**: í•´ë‹¹ ë°©ì†¡ì˜ ì‹¤ì œ ë§¤ì¶œì•¡ (ì˜ˆì¸¡ ëª©í‘œ)

---

## ğŸ“‹ API ëª…ì„¸ì„œ

### ë°©ì†¡ ì¶”ì²œ API

**Endpoint:** `POST /api/v1/broadcast/recommendations`

#### Request Body
```json
{
  "broadcastTime": "2025-09-15T22:40:00+09:00",
  "recommendationCount": 5
}
```

#### Response Body (Success: 200 OK)
```json
{
  "requestTime": "2025-08-25T14:01:44+09:00",
  "recommendedCategories": [
    {
      "rank": 1,
      "name": "ì£¼ë°©ìš©í’ˆ",
      "reason": "ê²½ìŸì‚¬ ë¶€ì¬ ë° 'ì£¼ë§ ì €ë…' í‚¤ì›Œë“œì™€ ê´€ë ¨ì„± ë†’ìŒ",
      "predictedSales": "9.8ì–µ"
    }
  ],
  "recommendations": [
    {
      "rank": 1,
      "productInfo": {
        "productId": "P300123",
        "productName": "[í•´í”¼ì½œ] ë‹¤ì´ì•„ëª¬ë“œ í”„ë¼ì´íŒ¬ 3ì¢… ì„¸íŠ¸",
        "category": "ìƒí™œ > ì£¼ë°©ìš©í’ˆ"
      },
      "reasoning": {
        "summary": "'ì£¼ë°©ìš©í’ˆ' ì¹´í…Œê³ ë¦¬ì˜ ì˜ˆìƒ ë§¤ì¶œì´ ë†’ê³ , ë™ì‹œê°„ëŒ€ ê²½ìŸì´ ì—†ì–´ ë…ì  ë°©ì†¡ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.",
        "linkedCategories": ["ì£¼ë°©ìš©í’ˆ"],
        "matchedKeywords": ["ì£¼ë§ ì €ë…", "ìš”ë¦¬"]
      },
      "businessMetrics": {
        "pastAverageSales": "8.5ì–µ",
        "marginRate": 0.35,
        "stockLevel": "Good"
      }
    }
  ]
}
```

---

## ğŸš€ ì‹œì‘í•˜ê¸° (ê°œë°œ í™˜ê²½ ì„¤ì •)

### ì‚¬ì „ ì¤€ë¹„
- Python 3.11+
- PostgreSQL 14+
- Docker & Docker Compose
- OpenAI API Key

### ì„¤ì¹˜ ë° ì‹¤í–‰

#### 1. ì €ì¥ì†Œ ë³µì œ
```bash
git clone https://github.com/your-repo/trnAi.git
cd trnAi
```

#### 2. Docker í™˜ê²½ ì„¤ì •
```bash
# Docker ë„¤íŠ¸ì›Œí¬ ìƒì„±
docker network create shopping-network

# ì„œë¹„ìŠ¤ ì‹¤í–‰
docker-compose up -d
```

#### 3. í™˜ê²½ë³€ìˆ˜ ì„¤ì •
`backend/.env` íŒŒì¼ì„ ìƒì„±í•˜ê³  ë‹¤ìŒ ì •ë³´ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤:
```env
DB_URI=postgresql://TRN_AI:TRN_AI@localhost:5432/TRNAI_DB
OPENAI_API_KEY=your_openai_api_key_here
```

#### 4. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
```bash
# PostgreSQL ì»¨í…Œì´ë„ˆì—ì„œ ì´ˆê¸° ìŠ¤í‚¤ë§ˆ ì‹¤í–‰
docker exec -i trnAi_postgres psql -U TRN_AI -d TRNAI_DB < init_database.sql
```

#### 5. XGBoost ëª¨ë¸ í•™ìŠµ
```bash
cd backend
python train.py
```

### ì„œë¹„ìŠ¤ ì ‘ì†
- **Backend API**: http://localhost:8501
- **API ë¬¸ì„œ**: http://localhost:8501/docs
- **Frontend**: http://localhost:3001
- **Qdrant**: http://localhost:6333
- **n8n**: http://localhost:5678

---

## ğŸ”® í–¥í›„ ê°œì„  ê³¼ì œ

- **ğŸ“ˆ ëª¨ë¸ A/B í…ŒìŠ¤íŒ…**: ì—¬ëŸ¬ ë²„ì „ì˜ ì¶”ì²œ ë¡œì§(ê°€ì¤‘ì¹˜, ëª¨ë¸ ë“±)ì„ ìš´ì˜ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸í•˜ê³  ì„±ê³¼ë¥¼ ë¹„êµí•˜ëŠ” ì‹œìŠ¤í…œ êµ¬ì¶•

- **âœï¸ ì‹¤ì‹œê°„ í”¼ë“œë°± ë£¨í”„**: PDê°€ AIì˜ ì¶”ì²œ ê²°ê³¼ë¥¼ í‰ê°€(ì¢‹ì•„ìš”/ì‹«ì–´ìš”)í•˜ê³ , ì´ í”¼ë“œë°±ì„ ë‹¤ìŒ ëª¨ë¸ í•™ìŠµì— ë°˜ì˜í•˜ëŠ” MLOps íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

- **ğŸ”— CI/CD ìë™í™”**: GitHub Actionsë¥¼ ì´ìš©í•œ í…ŒìŠ¤íŠ¸ ë° ë°°í¬ ìë™í™” íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

- **ğŸ í”„ë¡œëª¨ì…˜ ìë™ ì¶”ì²œ**: ìƒí’ˆê³¼ í•¨ê»˜ ë§¤ì¶œì„ ê·¹ëŒ€í™”í•  ìˆ˜ ìˆëŠ” ìµœì ì˜ í”„ë¡œëª¨ì…˜(ë¬´ì´ì í• ë¶€, ì‚¬ì€í’ˆ ë“±)ì„ í•¨ê»˜ ì œì•ˆí•˜ëŠ” ê¸°ëŠ¥ ì¶”ê°€