# 경쟁사 편성 데이터 활용 방안 변경 보고서

## 📋 요약

**기존 계획**: 실시간 경쟁사 회피 기능  
**변경 계획**: 경쟁사 트렌드 분석 기반 외부상품추천  
**변경 사유**: 데이터 시간차 문제로 실시간 회피 불가능

---

## 🚨 기존 계획의 문제점

### 1. 치명적 문제: 데이터 시간차 (Time Lag)

#### 현재 데이터 수집 구조
```
Day 1 20:00  → 경쟁사 실제 방송
Day 2 새벽   → 크롤링 & DB 저장
Day 2 이후   → 데이터 사용 가능
```

#### 문제 시나리오
```
상황: PD가 2025-10-28 저녁 8시 편성을 추천받고 싶음

1. API 호출
   POST /api/v1/broadcast/recommendations
   broadcastTime: "2025-10-28T20:00:00"

2. 경쟁사 조회
   SELECT * FROM taicompetitor_broadcasts
   WHERE broadcast_date = '2025-10-28'
   
   결과: 0개 (아직 방송 안 했으니 데이터 없음!)

3. 결론
   → 경쟁사 회피 기능 무용지물
```

### 2. 실현 불가능한 기능

| 기능 | 가능 여부 | 이유 |
|------|----------|------|
| 실시간 경쟁사 회피 | ❌ 불가능 | 미래 데이터 없음 |
| 과거 경쟁사 분석 | ✅ 가능 | 크롤링된 데이터 존재 |
| 패턴 기반 예측 | △ 부분 가능 | 정확도 낮음 (70-80%) |

### 3. 구현했던 기능 (제거됨)

```python
# broadcast_workflow.py
async def _get_competitor_categories(broadcast_time):
    """경쟁사가 방송 중인 카테고리 조회"""
    # 문제: 미래 시간에는 데이터 없음
    
# product_embedder.py
def search_products(exclude_keywords):
    """경쟁사 카테고리와 유사한 상품 제외"""
    # 문제: 제외할 카테고리가 없음
```

**제거 완료**: 2025-10-27

---

## 💡 새로운 방안: 외부상품추천

### 1. 컨셉 변경

#### 기존 (불가능)
```
❌ 실시간 경쟁사 회피
"지금 경쟁사가 방송하는 카테고리 제외"
→ 데이터 없어서 불가능
```

#### 변경 (실용적)
```
✅ 경쟁사 트렌드 분석
"경쟁사들이 최근 많이 편성하는 상품 = 시장에서 잘 팔리는 상품"
→ 과거 데이터로 분석 가능
→ 시장 트렌드 파악에 유용
```

### 2. 활용 방안

#### UI 구조
```
┌─────────────────────────────────────┐
│ [내부상품추천] [외부상품추천]       │
├─────────────────────────────────────┤
│                                     │
│ 외부상품추천                         │
│ "경쟁사들이 최근 많이 편성하는 상품" │
│                                     │
│ 📊 최근 7일 경쟁사 인기 카테고리     │
│ 1. 건강식품 (152회, +15% ↑)         │
│ 2. 의류패션 (143회, -5%)            │
│ 3. 뷰티 (128회, +8% ↑)              │
│                                     │
│ ⏰ 시간대별 인기                     │
│ • 20:00-22:00: 건강식품, 뷰티       │
│ • 14:00-16:00: 의류패션, 리빙       │
│                                     │
│ 💡 AI 인사이트                      │
│ "건강식품과 뷰티가 최근 인기 상승   │
│  중입니다. 시장 수요가 높은 시기로  │
│  판단됩니다."                        │
└─────────────────────────────────────┘
```

### 3. 제공 정보

#### 기본 분석
- 최근 N일간 경쟁사 인기 카테고리 Top 5
- 카테고리별 편성 횟수 및 증감률
- 시간대별 인기 카테고리

#### 고급 분석 (선택)
- 급상승 카테고리 (전주 대비 +15% 이상)
- 경쟁 강도 (시간대별 경쟁사 수)
- 블루오션 기회 (경쟁사가 안 하는 카테고리)

### 4. API 설계

```python
GET /api/v1/competitor/trends?days=7&broadcastTime=2025-10-28T20:00:00

응답:
{
  "period": "최근 7일",
  "broadcastTime": "2025-10-28T20:00:00",
  "analysis": {
    "topCategories": [
      {
        "category": "건강식품",
        "count": 152,
        "percentage": 18.5,
        "trend": "+15%",
        "insight": "최근 급상승 중"
      },
      {
        "category": "의류패션",
        "count": 143,
        "percentage": 17.4,
        "trend": "-5%",
        "insight": "안정적 수요"
      }
    ],
    "peakHours": {
      "20:00-22:00": ["건강식품", "뷰티"],
      "14:00-16:00": ["의류패션", "리빙"]
    },
    "recommendation": "건강식품과 뷰티 카테고리가 최근 인기 상승 중입니다."
  }
}
```

---

## 🎯 장점 비교

### 기존 계획 (경쟁사 회피)
- ❌ 실시간 데이터 없어서 불가능
- ❌ 패턴 예측은 부정확 (70-80%)
- ❌ 좋은 상품을 제외할 위험
- ❌ 유지보수 복잡

### 새로운 방안 (트렌드 분석)
- ✅ 과거 데이터로 충분히 가능
- ✅ 시장 트렌드 파악에 유용
- ✅ PD 의사결정에 도움
- ✅ 차별화 포인트 (경쟁사 분석)
- ✅ 구현 간단

---

## 📊 내부 vs 외부 추천 비교

| 구분 | 내부상품추천 | 외부상품추천 |
|------|-------------|-------------|
| **데이터 소스** | 우리 데이터 | 경쟁사 데이터 |
| **목적** | 최적 상품 추천 | 시장 트렌드 파악 |
| **기준** | AI + XGBoost | 경쟁사 편성 통계 |
| **활용** | 실제 편성 결정 | 참고 자료 |
| **강점** | 맞춤형 추천 | 시장 검증됨 |
| **업데이트** | 실시간 | 일 1회 (크롤링) |

---

## 📅 구현 계획

### Phase 1: 기본 API (우선순위 높음)
- [ ] GET /api/v1/competitor/trends
- [ ] 최근 N일 인기 카테고리 분석
- [ ] 시간대별 통계
- 예상 소요: 1-2일

### Phase 2: 고급 분석 (선택사항)
- [ ] 급상승 카테고리 감지
- [ ] 경쟁 강도 분석
- [ ] 블루오션 기회 제안
- 예상 소요: 2-3일

### Phase 3: 프론트엔드 (선택사항)
- [ ] 외부상품추천 탭 UI
- [ ] 차트 및 시각화
- [ ] 인사이트 표시
- 예상 소요: 3-5일

---

## 🎯 기대 효과

### 1. 실용성
- 실제 사용 가능한 기능
- PD에게 유용한 시장 정보 제공

### 2. 차별화
- 경쟁사 분석 기능 보유
- 시장 트렌드 기반 의사결정 지원

### 3. 확장성
- 다양한 분석 지표 추가 가능
- 계절별, 요일별 패턴 분석 가능

---

## 📝 결론

**변경 사유**: 데이터 시간차로 인해 실시간 경쟁사 회피 불가능  
**새로운 방향**: 경쟁사 트렌드 분석으로 시장 인사이트 제공  
**기대 효과**: 실용적이고 차별화된 기능으로 PD 의사결정 지원  

**승인 요청**: 외부상품추천 기능 구현 진행

---

**작성일**: 2025-10-27  
**작성자**: AI 개발팀  
**문서 버전**: 1.0
